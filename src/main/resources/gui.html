<html>
<head>
<title>
Settlement Controls
</title>

 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>          
 <script type="text/javascript">                                         
   // we will add our javascript code here                                     
 </script>

 <style type="text/css">
 	#achievement-buttons button { display: block; }
 </style>
</head>
<body>
<script>
     $(document).ready(function(){

        $.ajax({
          url: '/',
          datatype: "xml",
          success: function( xml ) {
              $(xml).find('player').each(function(){
                	$('#playercolor')
                        .append('<option value="' + $(this).attr("color") + '">' +  $(this).attr("name") + "</option>");
              })
                
                
              $(xml).find('rules achievement').each(function(){
                  	var achievement = $(this).attr("name");
                	$('#achievement-buttons')
                		.append($('<button>' + achievement + '</button>').click(function() {
                    		
               				var playercolor = $('#playercolor option:selected').val();

                    		$.ajax({ 
                        			type: "POST",
                        			url: "/players/" + playercolor + "/achievements/" + achievement,
                        	});

				            return false;
                		})
                	)
              })
          }
        })

        $('#minus-one').click(function() {
            var playercolor = $('#playercolor option:selected').val();

            $.ajax({ 
                url: "/players/" + playercolor,
                datatype: "xml",
                success: function ( xml ) {
                    $.ajax({ 
                        type: "POST",
                        url: "/players/" + playercolor,
                        data: '<player settlement_points="' + (parseInt($(xml).find('player').attr("victory_points")) - 1) + '"></player>',
                        });
                }
                });

            return false;
        });

        $('#plus-one').click(function() {
            var playercolor = $('#playercolor option:selected').val();

            $.ajax({ 
                url: "/players/" + playercolor,
                datatype: "xml",
                success: function ( xml ) {
                    $.ajax({ 
                        type: "POST",
                        url: "/players/" + playercolor,
                        data: '<player settlement_points="' + (parseInt($(xml).find('player').attr("victory_points")) + 1) + '"></player>',
                        });
                }
                });

            return false;
        })

     });

</script>
<form>
<div>
<div>
	<select id="playercolor"></select>
</div>
<div>
	<button id="minus-one">-1</button>
	<button id="plus-one">+1</button>
</div>
<div id="achievement-buttons">
</div>
</div>
</form>
</body>
</html>
